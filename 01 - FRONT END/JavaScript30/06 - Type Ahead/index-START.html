<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Type Ahead üëÄ</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="https://fav.farm/üî•" />
  </head>
  <body>
    <form class="search-form">
      <input
        type="text"
        class="search"
        name="search"
        placeholder="City or State"
      />
      <ul class="suggestions">
        <li>Filter for a city</li>
        <li>or a state</li>
      </ul>
    </form>
    <script>
      // URL de l'API contenant les donn√©es des villes am√©ricaines
      const endpoint =
        "https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json";

      // Variable globale pour stocker les donn√©es r√©cup√©r√©es
      let cities = [];

      // === R√âCUP√âRATION DES DONN√âES ===
      // Fonction asynchrone pour charger les donn√©es depuis l'API
      async function getDataApi() {
        // Requ√™te HTTP vers l'endpoint
        const storeDataApi = await fetch(endpoint);
        // Conversion de la r√©ponse en format JSON
        const responseDataApi = await storeDataApi.json();
        // Stockage global pour utilisation dans d'autres fonctions
        cities = responseDataApi;
        console.log(cities);
      }
      // Lancement imm√©diat du chargement des donn√©es
      getDataApi();

      // === FONCTION DE RECHERCHE ET AFFICHAGE ===
      // Filtre et affiche les r√©sultats en fonction de la saisie utilisateur
      function searchValue(event) {
        // Filtrage : recherche dans les noms de villes ET d'√©tats
        const data = cities.filter(
          (usa) =>
            usa.city.includes(event.target.value) ||
            usa.state.includes(event.target.value)
        );

        // R√©cup√©ration du conteneur pour afficher les r√©sultats
        const elementParent = document.querySelector(".suggestions");
        // Nettoyage des r√©sultats pr√©c√©dents
        elementParent.innerHTML = "";

        // Cr√©ation dynamique des √©l√©ments HTML pour chaque r√©sultat
        for (const city of data) {
          // Cr√©ation de l'√©l√©ment de liste
          const li = document.createElement("li");

          // Span pour afficher ville et √©tat
          const spanCity = document.createElement("span");
          spanCity.textContent = `${city.city}, ${city.state}`;

          // Span pour afficher la population
          const spanPopulation = document.createElement("span");
          spanPopulation.textContent = city.population;

          // Assemblage des √©l√©ments
          li.appendChild(spanCity);
          li.appendChild(spanPopulation);

          // Ajout √† la liste des suggestions
          elementParent.appendChild(li);
        }
      }

      // === LIAISON √âV√âNEMENT ===
      // Attachement de l'√©couteur d'√©v√©nement sur le champ de recherche
      const input = document.querySelector(".search");
      input.addEventListener("input", searchValue); // D√©clenchement √† chaque caract√®re tap√©
    </script>
  </body>
</html>
